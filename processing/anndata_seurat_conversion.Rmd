---
title: "SIG04 AnnData Seurat Conversion"
author: "Eric Y. Wang"
date: "`r Sys.Date()`"
output:
  html_notebook:
    toc: true
    toc_float: true
---

```{r setup}
library(tidyverse)
library(Seurat)
library(anndata)
knitr::opts_chunk$set(echo = TRUE)
```

For _SCT conversions. The pearson residuals will be contained in the "RNA" assay slot as the scale.data

```{r}
temp <- read_h5ad("C:/Users/Eric/My Drive/Lab/datasets/EYW/SIG04_10x_240816/python_outs/SIG04_SCT_no_multiplets_scanpy.h5ad")
```


```{r}
seruat <- CreateSeuratObject(assay = "RNA",
                           counts = t(as.matrix(temp$layers[["counts"]])),
                           meta.data = temp$obs)

# add umap embedding to seurat
umapEmbed <- as.matrix(seruat$obsm[["X_umap"]])
rownames(umapEmbed) <- colnames(seruat)
seruat[["umap"]] <- CreateDimReducObject(embeddings = umapEmbed, key = "umap_", assay = "RNA")

VariableFeatures(test) <- rownames(temp$var)[temp$var$highly_variable]
```












