genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
data
data$oBC_classification
data <- subset(data, subset = oBC_classification == "singlet")
pertNum <- data@meta.data %>%
group_by(oBC_feature_call) %>%
summarise(n = n())
pertNum <- data@meta.data %>%
group_by(oBC_feature_call) %>%
summarise(n = n())
pertNum
pertNum %>%
ggplot(aes(x="",y=n)) +
geom_violin()
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
coord_flip() +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
coord_flip() +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","IFNA"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call") +
scale_fill_viridis_c()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","IFNA","p129"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("GDF2","GDF7","GDF10","GDF11","GDF15","p129"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("GDF2","GDF7","GDF10","GDF11","GDF15"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("GDF2","GDF11","p129"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("GDF2","GDF11","p129"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","CCL21A","CXCL16","IFNA","p129"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"))
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call")
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2)
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
facet_wrap(~gem_group) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
data@meta.data %>%
group_by(oBC_feature_call,gem_group) %>%
summarise(n = n()) %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
facet_wrap(~gem_group) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
data@meta.data %>%
group_by(oBC_feature_call,gem_group) %>%
summarise(n = n()) %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
coord_flip() +
facet_wrap(~gem_group) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
degLane2 <- read_csv("analysis_outs/DEG_MAST_lane2.csv")
degLane2 <- degLane2 %>%
filter(!grepl("-pool",comp_1))
degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Full")
degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Lane 2")
# categorize genes by uniqueness
geneClass <- degFulloBCcovSig %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "1-5",
n_ligand > 5 & n_ligand <=10 ~ "5-10",
n_ligand > 10 ~ "10+")) %>%
mutate(class = factor(class, c("unique","1-5","5-10","10+")))
# categorize genes by uniqueness
geneClassLane2 <- degFulloBCcovSig %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "1-5",
n_ligand > 5 & n_ligand <=10 ~ "5-10",
n_ligand > 10 ~ "10+")) %>%
mutate(class = factor(class, c("unique","1-5","5-10","10+")))
geneClassLane2 %>%
filter(class == "10+")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","CCL21A","CXCL16","IFNA","p129") % gem_group == "lane2")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","CCL21A","CXCL16","IFNA","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2)
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2, pt.size = 0)
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","CCL21A","CCL4","CCL5","IFNA","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
VlnPlot(dataSub, c("Ifi27","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2, pt.size = 0)
VlnPlot(dataSub, c("Izumo1r","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2, pt.size = 0)
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","IFNA","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("GDF2","GDF11","p129"))
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("GDF2","GDF11","p129"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("GDF2","GDF11","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("GDF2","GDF11","p129"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","IFNA","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
dataSub$oBC_num_umis
dataSub
test <- tibble(Ifi27l2a = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["Ifi27l2a",],
oBC_nCount = dataSub$oBC_num_umis,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
test
test <- tibble(Ifi27l2a = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["Ifi27l2a",],
oBC_nCount = dataSub$oBC_log1p_total_counts,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
test %>%
ggplot(aes(x = Ifi27l2a, y = oBC_nCount)) +
geom_point()
test %>%
ggplot(aes(x = Ifi27l2a, y = oBC_nCount)) +
geom_point() +
facet_wrap(~feature_call)
test <- tibble(Ifi27l2a_counts = GetAssayData(dataSub, assay = "RNA", layer = "counts")["Ifi27l2a",],
Ifi27l2a_scale = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["Ifi27l2a",],
oBC_nCount = dataSub$oBC_log1p_total_counts,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
test %>%
filter(gem_group == "lane2") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_point() +
facet_wrap(~feature_call)
library(ggpointdensity)
test %>%
filter(gem_group == "lane2") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity()
test %>%
filter(gem_group == "lane2") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
facet_wrap(~feature_call)
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL9") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_fill_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL9") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "IFNA") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "p129") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL11") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL10") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL11") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL10") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "CXCL9") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
library(ggpointdensity)
test <- tibble(Ifi27l2a_counts = GetAssayData(dataSub, assay = "RNA", layer = "counts")["Hivep3",],
Ifi27l2a_scale = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["Hivep3",],
oBC_nCount = dataSub$oBC_log1p_total_counts,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "p129") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "p129") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
geom_contour() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
filter(feature_call == "p129") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
geom_density_2d() +
scale_color_viridis_c()
test %>%
filter(gem_group == "lane2") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
geom_density_2d() +
scale_color_viridis_c()
library(ggpointdensity)
test <- tibble(Ifi27l2a_counts = GetAssayData(dataSub, assay = "RNA", layer = "counts")["p139-T7-oBC5p",],
Ifi27l2a_scale = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["p139-T7-oBC5p",],
oBC_nCount = dataSub$oBC_log1p_total_counts,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
rownames(dataSub)
rownames(dataSub)[length(rownames(dataSub))]
library(ggpointdensity)
test <- tibble(Ifi27l2a_counts = GetAssayData(dataSub, assay = "RNA", layer = "counts")["p139-T7oBC5p-MS2",],
Ifi27l2a_scale = GetAssayData(dataSub, assay = "RNA", layer = "scale.data")["p139-T7oBC5p-MS2",],
oBC_nCount = dataSub$oBC_log1p_total_counts,
gem_group = dataSub$gem_group,
feature_call = dataSub$oBC_feature_call)
test %>%
filter(gem_group == "lane2") %>%
ggplot(aes(x = Ifi27l2a_scale, y = oBC_nCount)) +
geom_pointdensity() +
geom_density_2d() +
scale_color_viridis_c()
geneClass %>%
filter(class == "10+")
geneClassLane2 %>%
filter(class == "10+")
degFulloBCcovSig <- degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degFulloBCcovSig,"DEG_MAST_full_sig_geneClass.csv")
degFulloBCcovSig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degFulloBCcovSig,"DEG_MAST_lane2_sig_geneClass.csv")
geneClass %>%
filter(class == "10+")
geneClassLane2 %>%
filter(class == "10+")
degFulloBCcovSig <- degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degFulloBCcovSig,"analysis_outs/DEG_MAST_full_sig_geneClass.csv")
degFulloBCcovSig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degFulloBCcovSig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
# categorize genes by uniqueness
geneClass <- degFulloBCcovSig %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","1-5","5-10","10+")))
# categorize genes by uniqueness
geneClassLane2 <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","1-5","5-10","10+")))
geneClass %>%
filter(class == "10+")
geneClassLane2 %>%
filter(class == "10+")
degFulloBCcovSig <- degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degFulloBCcovSig,"analysis_outs/DEG_MAST_full_sig_geneClass.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degLane2Sig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
degLane2 %>%
filter(p_val_adj < 0.1)
geneClassLane2
View(geneClassLane2)
# categorize genes by uniqueness
geneClass <- degFulloBCcovSig %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","moderate (1-5)","high (5-10)","very high (10+)")))
# categorize genes by uniqueness
geneClassLane2 <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","moderate (1-5)","high (5-10)","very high (10+)")))
geneClass %>%
filter(class == "10+")
geneClassLane2 %>%
filter(class == "10+")
degFulloBCcovSig <- degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degFulloBCcovSig,"analysis_outs/DEG_MAST_full_sig_geneClass.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degLane2Sig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
# subset data
dataSub <- subset(data, subset = oBC_feature_call %in% c("CXCL9","CXCL10","CXCL11","CXCL12","IFNA","p129") & gem_group == "lane2")
dataSub <- ScaleData(dataSub, features = rownames(dataSub))
# make heatmap with significant genes
genes <-  filter(degSig, comp_1 %in% c("CXCL9","CXCL10","CXCL11"))$genes %>% unique()
DoHeatmap(dataSub, features = genes, group.by = "oBC_feature_call")
VlnPlot(dataSub, c("Izumo1r","Ifi27l2a","Tap1","Stat1"), group.by = "oBC_feature_call", ncol = 2, pt.size = 0)
library(tidyverse)
library(Seurat)
library(ggplot2)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
source("functions/plotting_fxns.R")
source("functions/scRNA_seq_analysis_functions.R")
theme_set(theme_Publication())
# import seurat object and subset to singlets
data <- readRDS("C:/Users/Eric/Documents/datasets/EYW/SIG04_10x_240816/seurat_outs/SIG04_postqc_seurat.rds")
data <- subset(data, subset = oBC_classification == "singlet")
Idents(data) <- "oBC_feature_call"
FindMarkers(data, min.pct = 0.05, ident.1 = "IL4",ident.2 = "IL12")
test1 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL4",ident.2 = "IL12")
test1 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL4-pool",ident.2 = "IL12-pool")
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL4-pool",ident.2 = "IL12-pool")
test1 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL4",ident.2 = "IL12")
View(test2)
View(test1)
test1 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IFNG",ident.2 = "IL12")
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IFNG-pool",ident.2 = "IL12-pool")
View(test2)
View(test1)
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "CCL25",ident.2 = "p129")
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL6-pool",ident.2 = "IL6-pool")
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL6",ident.2 = "IL6-pool")
test2 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL6-pool",ident.2 = "IL6")
test3 <- FindMarkers(data, min.pct = 0.05, ident.1 = "IL4-pool",ident.2 = "IL6-pool")
View(test3)
test3 <- FindMarkers(data, ident.1 = "IL4-pool",ident.2 = "IL6-pool")
