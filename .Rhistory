ggtitle("DEG nCount Lane 2") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1+p2
library(tidyverse)
library(Seurat)
library(ggplot2)
library(patchwork)
library(ggrepel)
knitr::opts_chunk$set(echo = TRUE)
source("functions/plotting_fxns.R")
source("functions/scRNA_seq_analysis_functions.R")
theme_set(theme_Publication())
dataLog1p <- read_csv("analysis_outs/mean_aggregated_normUMI_log1p.csv") %>%
pivot_longer(-oBC_feature_call, names_to = "genes", values_to = "expression")
dataZscore <- read_csv("analysis_outs/mean_aggregated_normUMI_Zscore.csv") %>%
pivot_longer(-oBC_feature_call, names_to = "genes", values_to = "expression")
scatterViz <- function(data,x,y,label=FALSE,label_x=NA,label_y=NA){
data <- filter(data, oBC_feature_call %in% c(x,y)) %>%
pivot_wider(id_cols = genes, names_from = oBC_feature_call, values_from = expression)
if(label == F){
p1 <- ggplot(data, aes_string(x=x, y=y)) +
geom_point() +
theme(aspect.ratio = 1)
}
if(label == T){
# make column for labels
data$label <- ifelse(data[[x]] > label_x | data[[x]] < -label_x | data[[y]] > label_y | data[[y]] < -label_y,
as.character(data$genes), NA)
p1 <- ggplot(data, aes_string(x=x, y=y)) +
geom_point() +
geom_text_repel(aes(label = label)) +
theme(aspect.ratio = 1)
}
return(p1)
}
dataZscore
scatterViz(dataZscore, "WNT1","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "CXCL11","CXCL9", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IFNG","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "GDF2","CCL25", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "CXCL11","CCL25", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "GDF2","CXCL11", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "GDF2","TNF", label = T, label_x = 0.2, label_y = 0.2) +
plot_layout(ncol=3)
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum <- data@meta.data %>%
group_by(oBC_feature_call) %>%
summarise(n = n())
pertNum
# import seurat object and subset to singlets
data <- readRDS("C:/Users/Eric/Documents/datasets/EYW/SIG04_10x_240816/seurat_outs/SIG04_postqc_seurat.rds")
data <- subset(data, subset = oBC_classification == "singlet")
pertNum <- data@meta.data %>%
group_by(oBC_feature_call) %>%
summarise(n = n())
pertNum
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
pertNum %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
data@meta.data %>%
group_by(oBC_feature_call,gem_group) %>%
summarise(n = n()) %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
facet_wrap(~gem_group) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
data@meta.data %>%
group_by(oBC_feature_call,gem_group) %>%
summarise(n = n()) %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
facet_wrap(~gem_group) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
data@meta.data %>%
group_by(oBC_feature_call,gem_group) %>%
summarise(n = n()) %>%
ggplot(aes(x=oBC_feature_call,y=n,fill=oBC_feature_call)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9), angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0)) +
facet_wrap(~gem_group, ncol = 1) +
xlab("ligand") +
ylab("# cells") +
ggtitle("Pert Quant in Full Dataset") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
degFulloBCcov <- degFulloBCcov %>%
filter(!grepl("-pool",comp_1))
degFullp139cov <- degFullp139cov %>%
filter(!grepl("-pool",comp_1))
degGem <- degGem %>%
filter(!grepl("-pool",comp_1))
degLane2 <- degLane2 %>%
filter(!grepl("-pool",comp_1))
p1 <- degFulloBCcov %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degFullp139cov %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1+p2
p1 <- degFulloBCcov %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degFullp139cov %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1/p2
p1 <- degGem %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1/p2
degLane2
degLane2 %>% filter(comp_1 == "IL2")
degGem %>% filter(comp_1 == "IL2")
degGem %>% filter(comp_1 == "IL2" & p_val_adj < 0.1)
degLane2 %>% filter(comp_1 == "IL2" & p_val_adj < 0.1)
p1 <- degGem %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder2(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1 <- degGem %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_rev(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_rev(fct_reorder(comp_1,n))) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1 <- degGem %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_reorder(comp_1,n)) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_rev(fct_reorder(comp_1,n))) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1/p2
p1 <- degGem %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_rev(fct_reorder(comp_1,n))) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG nCount oBC adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p2 <- degLane2 %>%
mutate(sig = ifelse(p_val_adj < 0.1,T,F)) %>%
group_by(comp_1) %>%
summarise(n = sum(sig)) %>%
mutate(comp_1 = fct_rev(fct_reorder(comp_1,n))) %>%
ggplot(aes(x=comp_1,y=n,fill=comp_1)) +
geom_bar(stat = "identity") +
geom_text(aes(label=n), position=position_dodge(width=0.9),angle=90, vjust=0.5, hjust=-0.25) +
scale_y_continuous(expand = c(0, 0), limits = c(0,1500)) +
xlab("ligand") +
ylab("# DEG (p_adj < 0.1)") +
ggtitle("DEG p139 transcript adjusted") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1/p2
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL7","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "TNF","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL33","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL17F","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL25","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "IL17B","IL17A", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "WNT1","IL17A", label = T, label_x = 0.2, label_y = 0.2)
scatterViz(dataZscore, "IL15","TGFB3", label = T, label_x = 0.2, label_y = 0.2) +
scatterViz(dataZscore, "CXCL11","CXCL9", label = T, label_x = 0.2, label_y = 0.2)
degFulloBCcov %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Full")
degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Lane 2")
degGem %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Full")
degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n = n()) %>%
ggplot(aes(x=n)) +
geom_histogram() +
xlab("# of ligands in which DEG is present") +
ggtitle("distribution of genes Lane 2")
# categorize genes by uniqueness
geneClass <- degGem %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","moderate (1-5)","high (5-10)","very high (10+)")))
# categorize genes by uniqueness
geneClassLane2 <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
group_by(genes) %>%
summarise(n_ligand = n()) %>%
mutate(class = case_when(n_ligand == 1 ~ "unique",
n_ligand > 1 & n_ligand <=5 ~ "moderate (1-5)",
n_ligand > 5 & n_ligand <=10 ~ "high (5-10)",
n_ligand > 10 ~ "very high (10+)")) %>%
mutate(class = factor(class, c("unique","moderate (1-5)","high (5-10)","very high (10+)")))
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degGemSig,"analysis_outs/DEG_MAST_gem_sig_geneClass.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degLane2Sig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
degGemSig
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(geenes, n_ligand, class) %>%
unique()
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(genes, n_ligand, class) %>%
unique()
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degGemSig,"analysis_outs/DEG_MAST_gem_sig_geneClass.csv")
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(genes, n_ligand, class) %>%
unique()
write_csv(degGemSig,"analysis_outs/DEG_MAST_gem_sig_geneClass_genes_only.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degLane2Sig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(genes, n_ligand, class) %>%
unique()
write_csv(degGemSig,"analysis_outs/DEG_MAST_lane2_sig_geneClass_genes_only.csv")
degGemSig <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes")
write_csv(degGemSig,"analysis_outs/DEG_MAST_gem_sig_geneClass.csv")
degGemSigGenes <- degGem %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(genes, n_ligand, class) %>%
unique()
write_csv(degGemSig,"analysis_outs/DEG_MAST_gem_sig_geneClass_genes_only.csv")
degLane2Sig <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClassLane2, by="genes")
write_csv(degLane2Sig,"analysis_outs/DEG_MAST_lane2_sig_geneClass.csv")
degLane2SigGenes <- degLane2 %>%
filter(p_val_adj < 0.1) %>%
left_join(geneClass, by="genes") %>%
select(genes, n_ligand, class) %>%
unique()
write_csv(degGemSig,"analysis_outs/DEG_MAST_lane2_sig_geneClass_genes_only.csv")
